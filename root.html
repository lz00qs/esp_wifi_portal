<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes"><meta charset="UTF-8"><title>Wi-Fi Setup</title><style>body{margin:0;font-family:Arial,sans-serif;background:#f8f9fb;display:flex;justify-content:center;align-items:center;height:100%;overflow-y:auto;-webkit-overflow-scrolling:touch}.card{background:#fff;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,.08);padding:30px 24px;width:320px;text-align:center}.icon{font-size:48px;color:#3b82f6;margin-bottom:16px}h2{margin:0;font-size:20px;color:#333}p{margin:4px 0 20px;font-size:14px;color:#666}select,input{width:100%;padding:10px;border:1px solid #ccc;border-radius:6px;font-size:14px;box-sizing:border-box}.wifi-block{margin-bottom:12px;display:flex;gap:6px}.wifi-block select{flex:1}.wifi-block button{padding:0 12px;border:1px solid #3b82f6;background:#fff;color:#3b82f6;border-radius:6px;cursor:pointer;font-size:18px;line-height:1}.wifi-block button:active{background:#f0f7ff}.status{font-size:12px;color:#3b82f6;margin:-6px 0 12px;min-height:14px}#pwd{margin-bottom:30px}button.connect{width:100%;padding:12px;background:#3b82f6;color:#fff;border:0;border-radius:6px;font-size:16px;cursor:pointer}button.connect:active{background:#2563eb}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.4);display:none;justify-content:center;align-items:center;z-index:10}.modal{background:#fff;padding:20px;border-radius:10px;width:280px;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,.2)}.modal h3{margin:0 0 10px;font-size:18px;color:#333}.modal p{font-size:14px;color:#555;margin:6px 0}.modal button{margin-top:16px;padding:8px 16px;border:0;background:#3b82f6;color:#fff;border-radius:6px;cursor:pointer}.modal button:active{background:#2563eb}</style></head><body><div id="loading" style="text-align:center;font-size:18px;padding-top:40px">ðŸ”„ Scanning Wi-Fi networks...</div><div class="card" id="mainCard" style="display:none"><div class="icon">ðŸ“¶</div><h2>Connect to Wi-Fi</h2><p>Configure Wi-Fi for your device.</p><div class="wifi-block"><select id="ssid"><option value="">-- Select network (SSID) --</option></select><button onclick="refreshWiFi()">ðŸ”„</button></div><div id="status" class="status"></div><input type="password" id="pwd" placeholder="Password" maxlength="63" pattern=".{8,63}" required><button class="connect" onclick="connectWiFi()">Connect</button></div><div id="modalOverlay" class="modal-overlay"><div class="modal"><h3 id="modal-title"></h3><p id="modal-msg"></p><p id="modal-timer"></p><button id="closeBtn" onclick="closeModal()">Close</button></div></div><script>window.onload=()=>loadWiFiList(!1,!0);function refreshWiFi(){loadWiFiList(!0,!1)}function loadWiFiList(e=!0,t=!1){fetch("/scan").then(r=>r.json()).then(d=>{const s=document.getElementById("ssid");s.innerHTML='<option value="">-- Select network (SSID) --</option>';d.forEach(a=>{const o=document.createElement("option");o.value=a,o.textContent=a,s.appendChild(o)});t&&(document.getElementById("loading").style.display="none",document.getElementById("mainCard").style.display="block");e&&!t&&(showModal("Wi-Fi list refreshed","",0),setTimeout(()=>document.getElementById("status").innerText="",2e3))}).catch(r=>{e&&showModal("Scan Failed","Unable to fetch Wi-Fi list.",0),console.error("Scan fetch failed:",r)})}function connectWiFi(){const e=document.getElementById("ssid").value.trim();if(!e){showModal("No Network Selected","Please select a network.",0);return}const t=document.getElementById("pwd").value.trim();showModal("Connecting","",15);fetch("/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ssid:e,password:t})}).then(r=>r.json()).then(r=>{closeModal(),r.success?showModal("Success","Connected",3):showModal("Failed",r.message||"Could not connect.",0)}).catch(r=>{showModal("Error","Request failed: "+r,0)})}let modalCountdown=null;function showModal(e,t,c){document.getElementById("modal-title").innerText=e,document.getElementById("modal-msg").innerText=t;const r=document.getElementById("modal-timer"),n=document.getElementById("closeBtn");modalCountdown&&(clearInterval(modalCountdown),modalCountdown=null),c>0?(n.style.display="none",r.innerText=`Closing in ${c} seconds...`,modalCountdown=setInterval(()=>{c--,c>0?r.innerText=`Closing in ${c} seconds...`:(clearInterval(modalCountdown),modalCountdown=null,window.close())},1e3)):(r.innerText="",n.style.display="inline-block"),document.getElementById("modalOverlay").style.display="flex"}function closeModal(){document.getElementById("modalOverlay").style.display="none",modalCountdown&&(clearInterval(modalCountdown),modalCountdown=null)}</script></body></html>